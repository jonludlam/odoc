(executable
 (name test)
 (modules test)
 (libraries compiler-libs.toplevel alcotest fmt odoc_xref2 odoc_model odoc_xref_test))

(rule
 (targets test.output)
 (deps test.bc)
 (action
    (with-stdout-to %{targets} (run ./test.bc))))

(alias
 (name runtest)
 (action (diff test.expected test.output)))

(tests
  (names test_compose)
  (modules test_compose)
  (libraries alcotest fmt odoc_xref2 odoc_model))
